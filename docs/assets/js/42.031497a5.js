(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{357:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"mysql恢复数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql恢复数据","aria-hidden":"true"}},[s._v("#")]),s._v(" MySQL恢复数据")]),s._v(" "),t("h2",{attrs:{id:"目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录","aria-hidden":"true"}},[s._v("#")]),s._v(" 目录")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#1"}},[s._v("MySQL误操作通过binlog2sql恢复数据")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#2"}},[s._v("MySQL备份")])])]),s._v(" "),t("hr"),s._v(" "),t("h6",{attrs:{id:"_1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1","aria-hidden":"true"}},[s._v("#")]),s._v(" 1")]),s._v(" "),t("h2",{attrs:{id:"mysql误操作通过binlog2sql恢复数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql误操作通过binlog2sql恢复数据","aria-hidden":"true"}},[s._v("#")]),s._v(" MySQL误操作通过binlog2sql恢复数据")]),s._v(" "),t("h3",{attrs:{id:"使用此方式之前一定是mysql开启了bin-log的才可行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用此方式之前一定是mysql开启了bin-log的才可行","aria-hidden":"true"}},[s._v("#")]),s._v(" 使用此方式之前一定是MySQL开启了bin-log的才可行")]),s._v(" "),t("h2",{attrs:{id:"第一步如果没有安装开源工具binlog2sql那么请安装。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第一步如果没有安装开源工具binlog2sql那么请安装。","aria-hidden":"true"}},[s._v("#")]),s._v(" 第一步如果没有安装开源工具binlog2sql那么请安装。")]),s._v(" "),t("h4",{attrs:{id:"binlog2sql的使用详情：https-github-com-danfengcao-binlog2sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#binlog2sql的使用详情：https-github-com-danfengcao-binlog2sql","aria-hidden":"true"}},[s._v("#")]),s._v(" binlog2sql的使用详情：https://github.com/danfengcao/binlog2sql")]),s._v(" "),t("h3",{attrs:{id:"binlog2sql是一款简单易用的binlog解析工具，其中一个功能就是生成回滚sql。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#binlog2sql是一款简单易用的binlog解析工具，其中一个功能就是生成回滚sql。","aria-hidden":"true"}},[s._v("#")]),s._v(" binlog2sql是一款简单易用的binlog解析工具，其中一个功能就是生成回滚SQL。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/danfengcao/binlog2sql.git\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" binlog2sql/\npip "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -r requirements.txt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"mysql-server必须设置以下参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-server必须设置以下参数","aria-hidden":"true"}},[s._v("#")]),s._v(" MySQL server必须设置以下参数:")]),s._v(" "),t("div",{staticClass:"language-sehll line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[mysqld]\nserver_id = 1\nlog_bin = /var/log/mysql/mysql-bin.log\nmax_binlog_size = 1G\nbinlog_format = row\nbinlog_row_image = full\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"user需要的最小权限集合："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#user需要的最小权限集合：","aria-hidden":"true"}},[s._v("#")]),s._v(" user需要的最小权限集合：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" super"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("replication")]),s._v(" client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("replication")]),s._v(" slave\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#建议授权")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("REPLICATION")]),s._v(" SLAVE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("REPLICATION")]),s._v(" CLIENT "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"查看目前的binlog文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看目前的binlog文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看目前的binlog文件")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" master logs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"查询结果："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询结果：","aria-hidden":"true"}},[s._v("#")]),s._v(" 查询结果：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("Log_name")]),s._v(" "),t("th",[s._v("File_size")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("mysql-bin.000001")]),s._v(" "),t("td",[s._v("177")])]),s._v(" "),t("tr",[t("td",[s._v("mysql-bin.000002")]),s._v(" "),t("td",[s._v("437")])]),s._v(" "),t("tr",[t("td",[s._v("mysql-bin.000003")]),s._v(" "),t("td",[s._v("685")])]),s._v(" "),t("tr",[t("td",[s._v("mysql-bin.000004")]),s._v(" "),t("td",[s._v("1702399")])]),s._v(" "),t("tr",[t("td",[s._v("mysql-bin.000005")]),s._v(" "),t("td",[s._v("963964")])]),s._v(" "),t("tr",[t("td",[s._v("mysql-bin.000006")]),s._v(" "),t("td",[s._v("13118637")])]),s._v(" "),t("tr",[t("td",[s._v("mysql-bin.000007")]),s._v(" "),t("td",[s._v("26765043")])])])]),s._v(" "),t("h3",{attrs:{id:"可以看到最新的binlog文件是mysql-bin-000007，我们再定位误操作sql的binlog位置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#可以看到最新的binlog文件是mysql-bin-000007，我们再定位误操作sql的binlog位置","aria-hidden":"true"}},[s._v("#")]),s._v(" 可以看到最新的binlog文件是mysql-bin.000007，我们再定位误操作SQL的binlog位置")]),s._v(" "),t("h4",{attrs:{id:"binlog2sql-py文件在binlog2sql-binlog2sql-文件夹下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#binlog2sql-py文件在binlog2sql-binlog2sql-文件夹下","aria-hidden":"true"}},[s._v("#")]),s._v(" binlog2sql.py文件在binlog2sql/binlog2sql/ 文件夹下")]),s._v(" "),t("h4",{attrs:{id:"如果命令最后不加时间可输出最近操作的sql命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如果命令最后不加时间可输出最近操作的sql命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 如果命令最后不加时间可输出最近操作的SQL命令")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("python binlog2sql/binlog2sql.py -h127.0.0.1 -P端口 -u账号 -p"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v(" -d数据库 -t表 --start-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'binlog文件'")]),s._v(" --start-datetime"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'之前误操作的SQL执行开始时间'")]),s._v(" --stop-datetime"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'之前误操作的SQL执行结束时间'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"当程序跑完之后看最后一条数据最末尾："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#当程序跑完之后看最后一条数据最末尾：","aria-hidden":"true"}},[s._v("#")]),s._v(" 当程序跑完之后看最后一条数据最末尾：")]),s._v(" "),t("h4",{attrs:{id:"start-5117865-end-13679060-time-2018-06-12-10-07-53"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#start-5117865-end-13679060-time-2018-06-12-10-07-53","aria-hidden":"true"}},[s._v("#")]),s._v(" #start 5117865 end 13679060 time 2018-06-12 10:07:53")]),s._v(" "),t("h4",{attrs:{id:"开始位置（start-5117865）和结束位置（end-13679060）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开始位置（start-5117865）和结束位置（end-13679060）","aria-hidden":"true"}},[s._v("#")]),s._v(" 开始位置（start 5117865）和结束位置（end 13679060）")]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/MySQL_binlog.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"方式一："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方式一：","aria-hidden":"true"}},[s._v("#")]),s._v(" 方式一：")]),s._v(" "),t("h3",{attrs:{id:"rollback-sql文件，并检查回滚sql是否正确"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollback-sql文件，并检查回滚sql是否正确","aria-hidden":"true"}},[s._v("#")]),s._v(" rollback.sql文件，并检查回滚SQL是否正确")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("python binlog2sql/binlog2sql.py -h127.0.0.1 -P端口 -u账号 -p"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v(" -d数据库 -t表 --start-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'binlog文件'")]),s._v(" --start-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("开始位置 --stop-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("结束位置 -B "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" rollback.sql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"查看当前文件夹下是否生成了rollback-sql文件-确认回滚sql正确，如果有就执行回滚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看当前文件夹下是否生成了rollback-sql文件-确认回滚sql正确，如果有就执行回滚","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看当前文件夹下是否生成了rollback.sql文件,确认回滚SQL正确，如果有就执行回滚")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("mysql -h127.0.0.1 -P端口 -u账号 -p"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" rollback.sql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"方式二："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方式二：","aria-hidden":"true"}},[s._v("#")]),s._v(" 方式二：")]),s._v(" "),t("h3",{attrs:{id:"不生成rollback-sql文件，执行命令后在输出中检查回滚sql是否正确"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#不生成rollback-sql文件，执行命令后在输出中检查回滚sql是否正确","aria-hidden":"true"}},[s._v("#")]),s._v(" 不生成rollback.sql文件，执行命令后在输出中检查回滚SQL是否正确")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("python binlog2sql/binlog2sql.py -h127.0.0.1 -P端口 -u账号 -p"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v(" -d数据库 -t表 --start-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'binlog文件'")]),s._v(" --start-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("开始位置 --stop-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("结束位置 -B\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"确认回滚sql正确，执行回滚语句。登录mysql确认，数据回滚成功。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#确认回滚sql正确，执行回滚语句。登录mysql确认，数据回滚成功。","aria-hidden":"true"}},[s._v("#")]),s._v(" 确认回滚SQL正确，执行回滚语句。登录MySQL确认，数据回滚成功。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("python binlog2sql/binlog2sql.py -h127.0.0.1 -P端口 -u账号 -p"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v(" -d数据库 -t表 --start-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'binlog文件'")]),s._v(" --start-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("开始位置 --stop-position"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("结束位置 -B "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql -h127.0.0.1 -P端口 -u账号 -p"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("hr"),s._v(" "),t("h6",{attrs:{id:"_2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2","aria-hidden":"true"}},[s._v("#")]),s._v(" 2")]),s._v(" "),t("h1",{attrs:{id:"mysql备份-返回顶部"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql备份-返回顶部","aria-hidden":"true"}},[s._v("#")]),s._v(" MySQL备份 "),t("a",{attrs:{href:"#readme"}},[s._v("返回顶部")])]),s._v(" "),t("h2",{attrs:{id:"用mysqldump备份"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用mysqldump备份","aria-hidden":"true"}},[s._v("#")]),s._v(" 用mysqldump备份")]),s._v(" "),t("blockquote",[t("p",[s._v("如果是在本机上备份本机的数据库地址和端口可以不要，如果是在本机上备份其他主机上的数据库就需要地址和端口\nmysqldump命令需要手动输入密码，所以一般不输入"),t("code",[s._v("-p")]),s._v("参数")])]),s._v(" "),t("h3",{attrs:{id:"参数说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参数说明","aria-hidden":"true"}},[s._v("#")]),s._v(" 参数说明")]),s._v(" "),t("blockquote",[t("p",[s._v("-d 结构(--no-data:不导出任何数据，只导出数据库表结构)")])]),s._v(" "),t("blockquote",[t("p",[s._v("-t 数据(--no-create-info:只导出数据，而不添加CREATE TABLE 语句)")])]),s._v(" "),t("blockquote",[t("p",[s._v("-n (--no-create-db:只导出数据，而不添加CREATE DATABASE 语句）")])]),s._v(" "),t("blockquote",[t("p",[s._v("-R (--routines:导出存储过程以及自定义函数)")])]),s._v(" "),t("blockquote",[t("p",[s._v("-E (--events:导出事件)")])]),s._v(" "),t("blockquote",[t("p",[s._v("--triggers (默认导出触发器，使用--skip-triggers屏蔽导出)")])]),s._v(" "),t("blockquote",[t("p",[s._v("-B (--databases:导出数据库列表，单个库时可省略）")])]),s._v(" "),t("blockquote",[t("p",[s._v("--tables 表列表（单个表时可省略）")])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("①同时导出结构以及数据时可同时省略-d和-t")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("②同时不导出结构和数据可使用-ntd")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("③只导出存储过程和函数可使用-R -ntd")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("④导出所有(结构&数据&存储过程&函数&事件&触发器)使用-R -E(相当于①，省略了-d -t;触发器默认导出)")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("⑤只导出结构&函数&事件&触发器使用 -R -E -d")])])]),s._v(" "),t("h3",{attrs:{id:"导出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导出","aria-hidden":"true"}},[s._v("#")]),s._v(" 导出")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只导出结构&函数&事件&触发器使用")]),s._v("\nmysqldump -R -E -d -h需要备份的主机地址 -P端口 -u用户名 -p 数据库名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/backup.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只导出存储过程和函数可使用")]),s._v("\nmysqldump -R -ntd -h需要备份的主机地址 -P端口 -u用户名 -p 数据库名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/backup.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出单个数据库中所有(结构&数据&存储过程&函数&事件&触发器)到sql文件")]),s._v("\nmysqldump -R -E -h需要备份的主机地址 -P端口 -u用户名 -p 数据库名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/backup.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqldump 备份并压缩sql文件")]),s._v("\nmysqldump -R -E -h主机地址 -P端口 -u用户名 -p 数据库名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gzip")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/backup.sql.gz\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份所有的数据库到一个sql文件")]),s._v("\nmysqldump -R -E -h主机地址 -P端口 -u用户名 -p --all-databases "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /home/all.sql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"导入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导入","aria-hidden":"true"}},[s._v("#")]),s._v(" 导入")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用mysqldump导入本地sql文件")]),s._v("\nmysqldump -h主机地址 -P端口 -u用户名 数据库名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /home/backup.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql直接用压缩文件恢复")]),s._v("\ngunzip "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" backup.sql.gz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql -h主机地址 -P端口 -u用户名 -p密码 数据库名\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql从本地sql文件导入")]),s._v("\nmysql -h主机地址 -P端口 -u用户名 -p密码 数据库名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" backupfile.sql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录MySQL用source命令导入本地sql文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定数据库")]),s._v("\nuse 数据库名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导入数据（注意sql文件的路径）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("source")]),s._v(" /home/backup.sql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h3",{attrs:{id:"mysqldump两台主机同步备份"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysqldump两台主机同步备份","aria-hidden":"true"}},[s._v("#")]),s._v(" mysqldump两台主机同步备份")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("mysqldump -R -E -h导出的主机地址 -P端口 -u用户名 -p 数据库名 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql -h导入的主机地址 -P端口 -u用户名 -p密码 -C 数据库名\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("--opt等同于--add-drop-table，--add-locks，--create-options，--quick，--extended-insert，--lock-tables，--set-charset，--disable-keys。\n该选项默认开启， 可以用--skip-opt禁用。")]),s._v(" "),t("blockquote",[t("p",[s._v("1、--opt 在创建表结构之前 会有 DROP TABLE IF EXISTS")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("2、原表在创建的时候指定了AUTO_INCREMENT，在使用了--opt 仍然和建表时候一样存在参数，在使用参数--skip-opt的时候，忽略了此参数AUTO_INCREMENT")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("3、在使用参数--opt的时候，创建表的类型，字符集等等都是默认参数ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;当使用了--skip-opt的时候，这些参数都给忽略了")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("4、导出原表中的数据，--opt是一个insert多个value，在使用了--skip-opt的时候，是多个insert组成的；")])])]),s._v(" "),t("h4",{attrs:{id:"mysqldump数据导出参数说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysqldump数据导出参数说明","aria-hidden":"true"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"https://blog.csdn.net/hao7030187/article/details/77839968",target:"_blank",rel:"noopener noreferrer"}},[s._v("mysqldump数据导出参数说明"),t("OutboundLink")],1)]),s._v(" "),t("h4",{attrs:{id:"mysqldump数据导出参数说明-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysqldump数据导出参数说明-2","aria-hidden":"true"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"http://www.cnblogs.com/chenmh/p/5300370.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("mysqldump数据导出参数说明"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"导出导入脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导出导入脚本","aria-hidden":"true"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"/VPS/script/MySQL_Backup.sh"}},[s._v("导出导入脚本")])]),s._v(" "),t("h2",{attrs:{id:"mysql-mysqldump导入导出-结构，数据，存储过程，函数，事件，触发器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-mysqldump导入导出-结构，数据，存储过程，函数，事件，触发器","aria-hidden":"true"}},[s._v("#")]),s._v(" MySQL mysqldump导入导出 结构，数据，存储过程，函数，事件，触发器")]),s._v(" "),t("p",[s._v("-------------------------数据库操作-----------------------------")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1.①导出一个库结构\n\nmysqldump -d dbname -u root -p > xxx.sql\n\n②导出多个库结构\n\nmysqldump -d -B dbname1 dbname2 -u root -p > xxx.sql\n\n2.①导出一个库数据\n\nmysqldump -t dbname -u root -p > xxx.sql\n\n②导出多个库数据\n\nmysqldump -t -B dbname1 dbname2 -u root -p > xxx.sql\n \n\n3.①导出一个库结构以及数据\n\nmysqldump dbname1 -u root -p > xxx.sql\n\n②导出多个库结构以及数据\n\nmysqldump -B dbname1 dbname2 -u root -p > xxx.sql\n\n-------------------------数据表操作-----------------------------\n\n4.①导出一个表结构\n\nmysqldump -d dbname1 tablename1 -u root -p > xxx.sql\n\n②导出多个表结构\n\nmysqldump -d -B dbname1 --tables tablename1 tablename2 -u root -p > xxx.sql\n \n\n5.①导出一个表数据\n\nmysqldump -t dbname1 tablename1 -u root -p > xxx.sql\n\n②导出多个表数据\n\nmysqldump -d -B dbname1 --tables tablename1 tablename2 -u root -p > xxx.sql\n \n\n6.①导出一个表结构以及数据\n\nmysqldump dbname1 tablename1 -u root -p > xxx.sql\n\n②导出多个表结构以及数据\n\nmysqldump -B dbname1 --tables tablename1 tablename2 -u root -p > xxx.sql\n\n-------------------------存储过程、函数操作-----------------------------\n\n7.只导出存储过程和函数(不导出结构和数据，要同时导出结构的话，需要同时使用-d)\n\nmysqldump -R -ndt dbname1 -u root -p > xxx.sql\n \n-------------------------事件操作-----------------------------\n8.只导出事件\n\nmysqldump -E -ndt dbname1 -u root -p > xxx.sql\n \n-------------------------触发器操作-----------------------------\n\n9.不导出触发器（触发器是默认导出的–triggers，使用–skip-triggers屏蔽导出触发器）\n\nmysqldump --skip-triggers dbname1 -u root -p > xxx.sql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br")])]),t("h1",{attrs:{id:"返回顶部"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#返回顶部","aria-hidden":"true"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#readme"}},[s._v("返回顶部")])])])},[],!1,null,null,null);a.default=e.exports}}]);