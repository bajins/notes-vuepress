(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{320:function(t,n,E){"use strict";E.r(n);var e=E(3),s=Object(e.a)({},function(){var t=this.$createElement,n=this._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[n("h1",{attrs:{id:"mysql异常捕获处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql异常捕获处理","aria-hidden":"true"}},[this._v("#")]),this._v(" MySQL异常捕获处理")]),this._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[this._v("DELIMITER $$\n-- 判断删除存储过程\nDROP PROCEDURE IF EXISTS err;\nCREATE PROCEDURE err() \nBEGIN\n\tDECLARE code VARCHAR(5) DEFAULT '00000';\n\tDECLARE msg TEXT;\n\tDECLARE errno INT;\n\t\n\t-- EXIT：发生错误时退出当前代码块\n\t-- DECLARE EXIT HANDLER FOR SQLEXCEPTION,SQLWARNING,NOT FOUND\n\t\n\t/*CONTINUE: 发送错误时继续执行后续代码\n\tSQLWARNING是对所有以01开头的SQLSTATE代码的速记\n\tNOT FOUND是对所有以02开头的SQLSTATE代码的速记\n\tSQLEXCEPTION是对所有没有被SQLWARNING或NOT FOUND捕获的SQLSTATE代码的速记*/\n\tDECLARE CONTINUE  HANDLER FOR SQLEXCEPTION,SQLWARNING,NOT FOUND\n\t\n\tBEGIN -- 捕获到异常时执行的代码块\n\t-- 赋值错误代码给code变量，赋值错误信息给msg变量\n\tGET DIAGNOSTICS CONDITION 1 code = RETURNED_SQLSTATE,errno = MYSQL_ERRNO, msg = MESSAGE_TEXT;\n\t-- 保存错误信息到日志表中\n\t-- INSERT INTO sql_log(errno,code,description,create_time,message) VALUES(errno,code,'存储过程：err',NOW(),msg);\n\t\n\tSELECT CONCAT(\"ERROR \", errno,'[', code, '] ', msg) sqlerrm;\n\t\t\n\tEND;\n\tSELECT * FROM a;\n\t\nEND $$\nDELIMITER;\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[this._v("CALL err();\n")])])])])},[],!1,null,null,null);n.default=s.exports}}]);